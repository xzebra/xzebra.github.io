{{- /* theme-toggle is enabled */}}
{{- if (not site.Params.disableThemeToggle) }}
{{- /* theme is light */}}
{{- if (eq site.Params.defaultTheme "light") }}
<script>
  if (localStorage.getItem("pref-theme") === "dark") {
    document.body.classList.add('dark');
  }

</script>
{{- /* theme is dark */}}
{{- else if (eq site.Params.defaultTheme "dark") }}
<script>
  if (localStorage.getItem("pref-theme") === "light") {
    document.body.classList.remove('dark')
  }

</script>
{{- else }}
{{- /* theme is auto */}}
<script>
  if (localStorage.getItem("pref-theme") === "dark") {
    document.body.classList.add('dark');
  } else if (localStorage.getItem("pref-theme") === "light") {
    document.body.classList.remove('dark')
  } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.body.classList.add('dark');
  }

</script>
{{- end }}
{{- /* theme-toggle is disabled and theme is auto */}}
{{- else if (and (ne site.Params.defaultTheme "light") (ne site.Params.defaultTheme "dark"))}}
<!-- <script> -->
<!--   if (window.matchMedia('(prefers-color-scheme: dark)').matches) { -->
<!--     document.body.classList.add('dark'); -->
<!--   } -->
<!-- </script> -->
{{- end }}

<header class="header">
  <nav class="nav">
    {{- $currentPage := . }}
    <ul id="menu" style="margin-left: auto">
      {{- range site.Menus.main }}
      {{- $menu_item_url := (cond (strings.HasSuffix .URL "/") .URL (printf "%s/" .URL) ) | absLangURL }}
      {{- $page_url:= $currentPage.Permalink | absLangURL }}
      {{- $is_search := eq (site.GetPage .KeyName).Layout `search` }}
      <li>
        <a href="{{ .URL | absLangURL }}" title="{{ .Title | default .Name }} {{- cond $is_search (" (Alt + /)" |
          safeHTMLAttr) ("" | safeHTMLAttr ) }}" {{- cond $is_search (" accesskey=/" | safeHTMLAttr) ("" | safeHTMLAttr
          ) }}>
          <span {{- if eq $menu_item_url $page_url }} class="active" {{- end }}>
            {{- .Pre }}
            {{- .Name -}}
            {{ .Post -}}
          </span>
        </a>
      </li>
      {{- end }}
    </ul>
  </nav>
</header>
